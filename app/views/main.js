"use strict";
var core_1 = require("@angular/core");
var router_1 = require("@angular/router");
var item_1 = require("../models/items/item");
var Sqlite = require("nativescript-sqlite");
var ViewComponent = (function () {
    function ViewComponent(router) {
        var _this = this;
        this.router = router;
        this.eng_rand = "";
        this.thai_rand = "";
        this.type_rand = "";
        this.word_search = "";
        this.word_list = [];
        this.word_list2 = [];
        //Code ตอนที่ไม่มีอะไรเลย เริ่มสร้างจาก 1
        (new Sqlite("dicts.db")).then(function (db) {
            db.execSQL("CREATE TABLE IF NOT EXISTS dict (id INTEGER PRIMARY KEY AUTOINCREMENT, engWorld TEXT, thaiWorld TEXT ,type TEXT DEFAULT 'Noun' , sTime DATE DEFAULT Null )").then(function (id) {
                _this.database = db;
                console.log("CREAT TABLE ===> Success ");
                //this.insert();
                _this.fetch();
                db.execSQL("CREATE TABLE IF NOT EXISTS FAVORITE (id INTEGER PRIMARY KEY AUTOINCREMENT,word_id INTEGER)").then(function (id) {
                    _this.database = db;
                    console.log("CREATE FAVORITE Success");
                    _this.createHistory();
                    _this.btnSelectRandom();
                }, function (error) {
                    console.log("CREATE TABLE FAVORITE ERROR", error);
                });
            }, function (error) {
                console.log("CREATE TABLE ERROR", error);
            });
        }, function (error) {
            console.log("OPEN DB ERROR", error);
        });
        //เรียกใช้ database ที่มีอยู่แล้วชื่อ dicts.db
        /*new Sqlite("dicts.db").then(db =>{
            this.database = db;
            console.log("Open database Success")
            
        },error =>{
            console.log("Open DB ERROR" , error);
        })
        */
        //this.btnSelectRandom();
        //this.items = new Item();
    }
    ViewComponent.prototype.createHistory = function () {
        var _this = this;
        this.database.execSQL("CREATE TABLE IF NOT EXISTS HISTORY (id INTEGER PRIMARY KEY AUTOINCREMENT,word_id INTEGER ,sTime DATE)").then(function (id) {
            _this.database = _this.database;
            console.log("CREATE HISTORY Success");
        }, function (error) {
            console.log("CREATE TABLE HISTORY ERROR", error);
        });
    };
    ViewComponent.prototype.insert = function () {
        var _this = this;
        this.database.execSQL("INSERT INTO dict (engWorld, thaiWorld) VALUES (?,?)", ["red", "แดง"]).then(function (all_word) {
            console.log("INSERT RESULT => ", all_word);
            _this.fetch();
        }, function (error) {
            console.log("INSERT ERROR => ", error);
        });
    };
    ViewComponent.prototype.fetch = function () {
        var _this = this;
        console.log("Go to ===> fetch");
        this.database.all("SELECT * FROM dict").then(function (rows) {
            console.log(rows);
            _this.word_list = rows;
            /*for(var row in rows){
                console.log("Result ==v");
            
                console.log("result all ==> " , rows[row]);//result all
                console.log("eng_word ==> " , rows[row][1]); // result eng
                console.log("thai_word ==> " , rows[row][2]); //result thai
                console.log("type word ==> " , rows[row][3]); //result thai
            }*/
            for (var i = 0; i < rows.length; i++) {
                console.log("result ==>", rows[i]);
            }
        }, function (error) {
            console.log("SELECT ERROR ", error);
        });
    };
    ViewComponent.prototype.btnInsert = function () {
        console.log("click btnInsert");
        this.router.navigate(["insert"]), {
            transition: {
                name: "flip",
                dutation: 2000,
                curve: "linear"
            }
        };
        this.btnSelectRandom();
    };
    ViewComponent.prototype.btnSelect = function () {
        var _this = this;
        var search = this.word_search;
        if (search == "") {
            alert("มีช่องว่างนะไอ้โง่ .....");
        }
        else {
            console.log("Check ==> ", "Select ===> " + search);
            var temp = "%" + search + "%";
            this.database.all("SELECT * FROM dict WHERE engWorld LIKE (?) or thaiWorld LIKE (?)", [temp, temp]).then(function (rows) {
                if (rows == "") {
                    console.log("not word ===>  " + rows + "is " + search);
                    alert("ไม่มีคำว่า " + search + " ในฐานข้อมูล");
                }
                _this.word_list = rows;
                for (var row in rows) {
                    console.log("Result ==v");
                    /*for(var i=0 ; i <= rows.length ; i++ ){
                     console.log("result ==>" , rows[row][i]);
                    }*/
                    console.log("result all ==> ", rows[row]); //result all
                    console.log("eng_word ==> ", rows[row][1]); // result eng
                    console.log("thai_word ==> ", rows[row][2]); //result thai
                }
            }, function (error) {
                console.log("SELECT ERROR ", error);
            });
        }
    };
    ViewComponent.prototype.btnDelete = function () {
        console.log("Check == > ", " Delete");
        this.router.navigate(["delete"]), {};
        this.btnSelectRandom();
    };
    //  function use for listview
    ViewComponent.prototype.ngOnInit = function () {
        var self = this;
        self.getItem();
    };
    ViewComponent.prototype.onItemTap = function (args) {
        var self = this;
        var word = self.word_list2[args.index];
        //this.router.navigate(["view-list", word.id]);
        //console.log("------------------------ ItemTapped: " + args.index);
        console.log(JSON.stringify(word));
        var navigationExtras = {
            queryParams: {
                "word": JSON.stringify(word)
            }
        };
        this.router.navigate(["list-detail"], navigationExtras);
    };
    ViewComponent.prototype.getItem = function () {
        console.log("GET ITEM ================> ");
        var self = this;
        var temp_list;
        temp_list = self.word_list;
        console.log("temp_list ===== > ", temp_list);
        console.log("temp_list ===== > ", temp_list.length);
        for (var row in temp_list) {
            console.log(temp_list[row]);
            var model_item = new item_1.Item();
            model_item.id = temp_list[row][0];
            model_item.wordEng = temp_list[row][1];
            model_item.wordThai = temp_list[row][2];
            console.log(temp_list[row][0] + " " + temp_list[row][1] + " " + temp_list[row][2]);
            self.word_list2.push(model_item);
        }
    };
    ViewComponent.prototype.btnSelectRandom = function () {
        //console.log("Select Random");
        var _this = this;
        this.database.all("SELECT * FROM dict ORDER BY RANDOM() LIMIT 1").then(function (rows) {
            console.log(rows);
            console.log("eng_word ==> ", rows[0][1]); // result eng
            _this.eng_rand = rows[0][1];
            //this.items.wordEng = rows[0][1];
            //console.log("eng_word ITEM ==> " , this.items.wordEng); // result eng
            console.log("thai_word ==> ", rows[0][2]); //result thai
            _this.thai_rand = rows[0][2];
            //this.items.wordThai = rows[0][2];
            //console.log("eng_thai ITEM ==> " , this.items.wordThai); // result eng
            console.log("type word ==> ", rows[0][3]); //result type
            _this.type_rand = rows[0][3];
            //this.items.wordType = rows[0][3];
            //console.log("eng_type ITEM ==> " , this.items.wordType); // result eng
            /*for(var row in rows){
                console.log("Result ==v");
            
                console.log("result all ==> " , rows[0][0]);//result all

                console.log("eng_word ==> " , rows[row][1]); // result eng
                this.eng_rand = rows[row][1];
            
                console.log("thai_word ==> " , rows[row][2]); //result thai
                this.thai_rand = rows[row][2];


                console.log("type word ==> " , rows[row][3]); //result type
                this.type_rand = rows[row][3];
            }*/
            /*for(var i=0 ; i < rows.length ; i++ ){
                    console.log("result for row ==>" , rows[i]);
                }*/
            //this.eng_rand = rows[1];
        }, function (error) {
            console.log("SELECT ERROR ", error);
        });
    };
    return ViewComponent;
}());
ViewComponent = __decorate([
    core_1.Component({
        selector: "ns-app",
        templateUrl: "views/main.html",
    }),
    __metadata("design:paramtypes", [router_1.Router])
], ViewComponent);
exports.ViewComponent = ViewComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHNDQUFrRDtBQUNsRCwwQ0FBeUQ7QUFFekQsNkNBQTRDO0FBRzVDLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0FBUzVDLElBQWEsYUFBYTtJQWdCdEIsdUJBQTJCLE1BQWM7UUFBekMsaUJBdUNDO1FBdkMwQixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBWnpDLGFBQVEsR0FBRSxFQUFFLENBQUM7UUFDYixjQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ2YsY0FBUyxHQUFFLEVBQUUsQ0FBQztRQUVkLGdCQUFXLEdBQUUsRUFBRSxDQUFDO1FBRWhCLGNBQVMsR0FBRyxFQUFFLENBQUM7UUFDZixlQUFVLEdBQUcsRUFBRSxDQUFDO1FBUVoseUNBQXlDO1FBQ3pDLENBQUMsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxFQUFFO1lBQzVCLEVBQUUsQ0FBQyxPQUFPLENBQUMsNEpBQTRKLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxFQUFFO2dCQUM1SyxLQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztnQkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO2dCQUN6QyxnQkFBZ0I7Z0JBQ2hCLEtBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDYixFQUFFLENBQUMsT0FBTyxDQUFDLDRGQUE0RixDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsRUFBRTtvQkFDNUcsS0FBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7b0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLENBQUMsQ0FBQztvQkFDdkMsS0FBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO29CQUNyQixLQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7Z0JBQzNCLENBQUMsRUFBQyxV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QWEsQ0FzUXhCO0FBdFFXLHNDQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQge1JvdXRlciwgTmF2aWdhdGlvbkV4dHJhc30gZnJvbSBcIkBhbmd1bGFyL3JvdXRlclwiOyBcclxuXHJcbmltcG9ydCB7IEl0ZW0gfSBmcm9tIFwiLi4vbW9kZWxzL2l0ZW1zL2l0ZW1cIjtcclxuXHJcblxyXG52YXIgU3FsaXRlID0gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1zcWxpdGVcIik7XHJcblxyXG5cclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiBcIm5zLWFwcFwiLFxyXG4gICAgdGVtcGxhdGVVcmw6IFwidmlld3MvbWFpbi5odG1sXCIsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBWaWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICBwcml2YXRlIGRhdGFiYXNlIDogYW55O1xyXG5cclxuICAgIGVuZ19yYW5kID1cIlwiO1xyXG4gICAgdGhhaV9yYW5kID0gXCJcIjtcclxuICAgIHR5cGVfcmFuZCA9XCJcIjtcclxuXHJcbiAgICB3b3JkX3NlYXJjaCA9XCJcIjtcclxuICAgIFxyXG4gICAgd29yZF9saXN0ID0gW107XHJcbiAgICB3b3JkX2xpc3QyID0gW107XHJcblxyXG4gICAgXHJcbiAgICBcclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSByb3V0ZXI6IFJvdXRlciApe1xyXG5cclxuICAgICAgICBcclxuICAgICAgICAvL0NvZGUg4LiV4Lit4LiZ4LiX4Li14LmI4LmE4Lih4LmI4Lih4Li14Lit4Liw4LmE4Lij4LmA4Lil4LiiIOC5gOC4o+C4tOC5iOC4oeC4quC4o+C5ieC4suC4h+C4iOC4suC4gSAxXHJcbiAgICAgICAgKG5ldyBTcWxpdGUoXCJkaWN0cy5kYlwiKSkudGhlbihkYiA9PiB7XHJcbiAgICAgICAgICAgIGRiLmV4ZWNTUUwoXCJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBkaWN0IChpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsIGVuZ1dvcmxkIFRFWFQsIHRoYWlXb3JsZCBURVhUICx0eXBlIFRFWFQgREVGQVVMVCAnTm91bicgLCBzVGltZSBEQVRFIERFRkFVTFQgTnVsbCApXCIpLnRoZW4oaWQgPT57XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFiYXNlID0gZGI7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFUIFRBQkxFID09PT4gU3VjY2VzcyBcIik7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuaW5zZXJ0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZldGNoKCk7XHJcbiAgICAgICAgICAgICAgICBkYi5leGVjU1FMKFwiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgRkFWT1JJVEUgKGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCx3b3JkX2lkIElOVEVHRVIpXCIpLnRoZW4oaWQgPT57XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhYmFzZSA9IGRiO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ1JFQVRFIEZBVk9SSVRFIFN1Y2Nlc3NcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVIaXN0b3J5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TZWxlY3RSYW5kb20oKTtcclxuICAgICAgICAgICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDUkVBVEUgVEFCTEUgRkFWT1JJVEUgRVJST1JcIiAsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBUQUJMRSBFUlJPUlwiICwgZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKSAgIFxyXG4gICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiT1BFTiBEQiBFUlJPUlwiICwgZXJyb3IpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8v4LmA4Lij4Li14Lii4LiB4LmD4LiK4LmJIGRhdGFiYXNlIOC4l+C4teC5iOC4oeC4teC4reC4ouC4ueC5iOC5geC4peC5ieC4p+C4iuC4t+C5iOC4rSBkaWN0cy5kYlxyXG4gICAgICAgIC8qbmV3IFNxbGl0ZShcImRpY3RzLmRiXCIpLnRoZW4oZGIgPT57XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YWJhc2UgPSBkYjtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJPcGVuIGRhdGFiYXNlIFN1Y2Nlc3NcIilcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJPcGVuIERCIEVSUk9SXCIgLCBlcnJvcik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAqL1xyXG5cclxuICAgICAgICAvL3RoaXMuYnRuU2VsZWN0UmFuZG9tKCk7XHJcbiAgICAgICAgLy90aGlzLml0ZW1zID0gbmV3IEl0ZW0oKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY3JlYXRlSGlzdG9yeSgpe1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2UuZXhlY1NRTChcIkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIEhJU1RPUlkgKGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCx3b3JkX2lkIElOVEVHRVIgLHNUaW1lIERBVEUpXCIpLnRoZW4oaWQgPT57XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhYmFzZSA9IHRoaXMuZGF0YWJhc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDUkVBVEUgSElTVE9SWSBTdWNjZXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBUQUJMRSBISVNUT1JZIEVSUk9SXCIgLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcblxyXG5cclxuXHJcbiAgICBwdWJsaWMgaW5zZXJ0KCl7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZS5leGVjU1FMKFwiSU5TRVJUIElOVE8gZGljdCAoZW5nV29ybGQsIHRoYWlXb3JsZCkgVkFMVUVTICg/LD8pXCIsIFtcInJlZFwiICxcIuC5geC4lOC4h1wiXSkudGhlbihhbGxfd29yZCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIklOU0VSVCBSRVNVTFQgPT4gXCIgLCBhbGxfd29yZCAgKTtcclxuICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLmZldGNoKCk7XHJcbiAgICAgICAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJJTlNFUlQgRVJST1IgPT4gXCIgLCBlcnJvcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBmZXRjaCgpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiR28gdG8gPT09PiBmZXRjaFwiKTtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlLmFsbChcIlNFTEVDVCAqIEZST00gZGljdFwiKS50aGVuKHJvd3MgPT57XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJvd3MpO1xyXG4gICAgICAgICAgICB0aGlzLndvcmRfbGlzdCA9IHJvd3M7XHJcbiAgICAgICAgICAgIC8qZm9yKHZhciByb3cgaW4gcm93cyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3VsdCA9PXZcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXN1bHQgYWxsID09PiBcIiAsIHJvd3Nbcm93XSk7Ly9yZXN1bHQgYWxsXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVuZ193b3JkID09PiBcIiAsIHJvd3Nbcm93XVsxXSk7IC8vIHJlc3VsdCBlbmdcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGhhaV93b3JkID09PiBcIiAsIHJvd3Nbcm93XVsyXSk7IC8vcmVzdWx0IHRoYWlcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHlwZSB3b3JkID09PiBcIiAsIHJvd3Nbcm93XVszXSk7IC8vcmVzdWx0IHRoYWlcclxuICAgICAgICAgICAgfSovXHJcbiAgICAgICAgICAgIGZvcih2YXIgaT0wIDsgaSA8IHJvd3MubGVuZ3RoIDsgaSsrICl7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXN1bHQgPT0+XCIgLCByb3dzW2ldKTsgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTRUxFQ1QgRVJST1IgXCIgLCBlcnJvcik7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBidG5JbnNlcnQoKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImNsaWNrIGJ0bkluc2VydFwiKTtcclxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJpbnNlcnRcIl0pLHtcclxuICAgICAgICAgICAgdHJhbnNpdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgbmFtZSA6IFwiZmxpcFwiICxcclxuICAgICAgICAgICAgICAgIGR1dGF0aW9uOiAyMDAwLFxyXG4gICAgICAgICAgICAgICAgY3VydmU6IFwibGluZWFyXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmJ0blNlbGVjdFJhbmRvbSgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGJ0blNlbGVjdCgpe1xyXG4gICAgICAgIHZhciBzZWFyY2ggPSB0aGlzLndvcmRfc2VhcmNoO1xyXG4gICAgICAgIGlmIChzZWFyY2ggPT0gXCJcIil7XHJcbiAgICAgICAgICAgIGFsZXJ0KFwi4Lih4Li14LiK4LmI4Lit4LiH4Lin4LmI4Liy4LiH4LiZ4Liw4LmE4Lit4LmJ4LmC4LiH4LmIIC4uLi4uXCIpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNrID09PiBcIiAsIFwiU2VsZWN0ID09PT4gXCIgKyBzZWFyY2gpO1xyXG4gICAgICAgICAgICAgdmFyIHRlbXAgPSBcIiVcIitzZWFyY2grXCIlXCI7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmRhdGFiYXNlLmFsbChcIlNFTEVDVCAqIEZST00gZGljdCBXSEVSRSBlbmdXb3JsZCBMSUtFICg/KSBvciB0aGFpV29ybGQgTElLRSAoPylcIixbdGVtcCx0ZW1wXSApLnRoZW4ocm93cyA9PntcclxuICAgICAgICAgICAgICAgIGlmKHJvd3MgPT1cIlwiKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdCB3b3JkID09PT4gIFwiICsgcm93cyArIFwiaXMgXCIgKyBzZWFyY2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi4LmE4Lih4LmI4Lih4Li14LiE4Liz4Lin4LmI4LiyIFwiICsgc2VhcmNoICsgXCIg4LmD4LiZ4LiQ4Liy4LiZ4LiC4LmJ4Lit4Lih4Li54LilXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy53b3JkX2xpc3QgPSByb3dzO1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciByb3cgaW4gcm93cyl7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXN1bHQgPT12XCIpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qZm9yKHZhciBpPTAgOyBpIDw9IHJvd3MubGVuZ3RoIDsgaSsrICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdCA9PT5cIiAsIHJvd3Nbcm93XVtpXSk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9Ki9cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdCBhbGwgPT0+IFwiICwgcm93c1tyb3ddKTsvL3Jlc3VsdCBhbGxcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVuZ193b3JkID09PiBcIiAsIHJvd3Nbcm93XVsxXSk7IC8vIHJlc3VsdCBlbmdcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRoYWlfd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bMl0pOyAvL3Jlc3VsdCB0aGFpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBFUlJPUiBcIiAsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcblxyXG4gICAgYnRuRGVsZXRlKCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJDaGVjayA9PSA+IFwiICwgXCIgRGVsZXRlXCIpO1xyXG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcImRlbGV0ZVwiXSkse1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5idG5TZWxlY3RSYW5kb20oKTtcclxuICAgICAgICAgXHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICAvLyAgZnVuY3Rpb24gdXNlIGZvciBsaXN0dmlld1xyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG5cdFx0c2VsZi5nZXRJdGVtKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25JdGVtVGFwKGFyZ3MpIHtcclxuXHRcdGxldCBzZWxmID0gdGhpcztcclxuXHRcdGxldCB3b3JkID0gc2VsZi53b3JkX2xpc3QyW2FyZ3MuaW5kZXhdO1xyXG5cdFx0Ly90aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJ2aWV3LWxpc3RcIiwgd29yZC5pZF0pO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gSXRlbVRhcHBlZDogXCIgKyBhcmdzLmluZGV4KTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkod29yZCkgKTtcclxuICAgICAgICBsZXQgbmF2aWdhdGlvbkV4dHJhczogTmF2aWdhdGlvbkV4dHJhcyA9IHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgIFwid29yZFwiOiBKU09OLnN0cmluZ2lmeSh3b3JkKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJsaXN0LWRldGFpbFwiXSwgbmF2aWdhdGlvbkV4dHJhcyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SXRlbSgpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiR0VUIElURU0gPT09PT09PT09PT09PT09PT4gXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgdGVtcF9saXN0IDogQXJyYXk8YW55PjtcclxuICAgICAgICB0ZW1wX2xpc3QgPSBzZWxmLndvcmRfbGlzdDtcclxuXHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwidGVtcF9saXN0ID09PT09ID4gXCIsdGVtcF9saXN0KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInRlbXBfbGlzdCA9PT09PSA+IFwiLHRlbXBfbGlzdC5sZW5ndGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvcih2YXIgcm93IGluIHRlbXBfbGlzdCl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRlbXBfbGlzdFtyb3ddKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBtb2RlbF9pdGVtIDogSXRlbSA9IG5ldyBJdGVtKCk7XHJcblxyXG4gICAgICAgICAgICBtb2RlbF9pdGVtLmlkID0gdGVtcF9saXN0W3Jvd11bMF07XHJcbiAgICAgICAgICAgIG1vZGVsX2l0ZW0ud29yZEVuZyA9IHRlbXBfbGlzdFtyb3ddWzFdO1xyXG4gICAgICAgICAgICBtb2RlbF9pdGVtLndvcmRUaGFpID0gdGVtcF9saXN0W3Jvd11bMl07XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0ZW1wX2xpc3Rbcm93XVswXSArXCIgXCIgKyB0ZW1wX2xpc3Rbcm93XVsxXSArXCIgXCIgKyB0ZW1wX2xpc3Rbcm93XVsyXSApO1xyXG5cclxuICAgICAgICAgICAgc2VsZi53b3JkX2xpc3QyLnB1c2gobW9kZWxfaXRlbSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgIFxyXG5cclxuICAgIH1cclxuXHJcbiAgICBidG5TZWxlY3RSYW5kb20oKXtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKFwiU2VsZWN0IFJhbmRvbVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZS5hbGwoXCJTRUxFQ1QgKiBGUk9NIGRpY3QgT1JERVIgQlkgUkFORE9NKCkgTElNSVQgMVwiKS50aGVuKHJvd3MgPT57XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJvd3MpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbmdfd29yZCA9PT4gXCIgLCByb3dzWzBdWzFdKTsgLy8gcmVzdWx0IGVuZ1xyXG4gICAgICAgICAgICB0aGlzLmVuZ19yYW5kID0gcm93c1swXVsxXTtcclxuICAgICAgICAgICAgLy90aGlzLml0ZW1zLndvcmRFbmcgPSByb3dzWzBdWzFdO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiZW5nX3dvcmQgSVRFTSA9PT4gXCIgLCB0aGlzLml0ZW1zLndvcmRFbmcpOyAvLyByZXN1bHQgZW5nXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInRoYWlfd29yZCA9PT4gXCIgLCByb3dzWzBdWzJdKTsgLy9yZXN1bHQgdGhhaVxyXG4gICAgICAgICAgICB0aGlzLnRoYWlfcmFuZCA9IHJvd3NbMF1bMl07XHJcbiAgICAgICAgICAgIC8vdGhpcy5pdGVtcy53b3JkVGhhaSA9IHJvd3NbMF1bMl07XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJlbmdfdGhhaSBJVEVNID09PiBcIiAsIHRoaXMuaXRlbXMud29yZFRoYWkpOyAvLyByZXN1bHQgZW5nXHJcblxyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0eXBlIHdvcmQgPT0+IFwiICwgcm93c1swXVszXSk7IC8vcmVzdWx0IHR5cGVcclxuICAgICAgICAgICAgdGhpcy50eXBlX3JhbmQgPSByb3dzWzBdWzNdO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXRlbXMud29yZFR5cGUgPSByb3dzWzBdWzNdO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiZW5nX3R5cGUgSVRFTSA9PT4gXCIgLCB0aGlzLml0ZW1zLndvcmRUeXBlKTsgLy8gcmVzdWx0IGVuZ1xyXG5cclxuICAgICAgICAgICAgLypmb3IodmFyIHJvdyBpbiByb3dzKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzdWx0ID09dlwiKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdCBhbGwgPT0+IFwiICwgcm93c1swXVswXSk7Ly9yZXN1bHQgYWxsXHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbmdfd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bMV0pOyAvLyByZXN1bHQgZW5nXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ19yYW5kID0gcm93c1tyb3ddWzFdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGhhaV93b3JkID09PiBcIiAsIHJvd3Nbcm93XVsyXSk7IC8vcmVzdWx0IHRoYWlcclxuICAgICAgICAgICAgICAgIHRoaXMudGhhaV9yYW5kID0gcm93c1tyb3ddWzJdO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInR5cGUgd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bM10pOyAvL3Jlc3VsdCB0eXBlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGVfcmFuZCA9IHJvd3Nbcm93XVszXTtcclxuICAgICAgICAgICAgfSovXHJcbiAgICAgICAgICAgIC8qZm9yKHZhciBpPTAgOyBpIDwgcm93cy5sZW5ndGggOyBpKysgKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdCBmb3Igcm93ID09PlwiICwgcm93c1tpXSk7IFxyXG4gICAgICAgICAgICAgICAgfSovXHJcblxyXG5cclxuICAgICAgICAgICAgLy90aGlzLmVuZ19yYW5kID0gcm93c1sxXTtcclxuXHJcbiAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTRUxFQ1QgRVJST1IgXCIgLCBlcnJvcik7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBcclxuXHJcbiAgICBcclxuXHJcblxyXG4gfVxyXG4iXX0=