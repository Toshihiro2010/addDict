"use strict";
var core_1 = require("@angular/core");
var router_1 = require("@angular/router");
var item_1 = require("../models/items/item");
var Sqlite = require("nativescript-sqlite");
var ViewComponent = (function () {
    function ViewComponent(router) {
        var _this = this;
        this.router = router;
        this.eng_rand = "";
        this.thai_rand = "";
        this.type_rand = "";
        this.word_search = "";
        this.word_list = [];
        this.word_list2 = [];
        //Code ตอนที่ไม่มีอะไรเลย เริ่มสร้างจาก 1
        (new Sqlite("dicts.db")).then(function (db) {
            db.execSQL("CREATE TABLE IF NOT EXISTS dict (id INTEGER PRIMARY KEY AUTOINCREMENT, engWorld TEXT, thaiWorld TEXT ,type TEXT DEFAULT 'Noun',favorite NUMBER DEFAULT 0 , sTime DATE DEFAULT Null )").then(function (id) {
                _this.database = db;
                console.log("CREAT TABLE ===> Success ");
                //this.insert();
                _this.fetch();
                db.execSQL("CREATE TABLE IF NOT EXISTS FAVORITE (id INTEGER PRIMARY KEY AUTOINCREMENT,word_id INTEGER)").then(function (id) {
                    _this.database = db;
                    console.log("CREATE FAVORITE Success");
                    _this.createHistory();
                    _this.btnSelectRandom();
                }, function (error) {
                    console.log("CREATE TABLE FAVORITE ERROR", error);
                });
            }, function (error) {
                console.log("CREATE TABLE ERROR", error);
            });
        }, function (error) {
            console.log("OPEN DB ERROR", error);
        });
        //เรียกใช้ database ที่มีอยู่แล้วชื่อ dicts.db
        /*new Sqlite("dicts.db").then(db =>{
            this.database = db;
            console.log("Open database Success")
            
        },error =>{
            console.log("Open DB ERROR" , error);
        })
        */
        //this.btnSelectRandom();
        //this.items = new Item();
    }
    ViewComponent.prototype.createHistory = function () {
        var _this = this;
        this.database.execSQL("CREATE TABLE IF NOT EXISTS HISTORY (id INTEGER PRIMARY KEY AUTOINCREMENT,word_id INTEGER ,sTime DATE)").then(function (id) {
            _this.database = _this.database;
            console.log("CREATE HISTORY Success");
        }, function (error) {
            console.log("CREATE TABLE HISTORY ERROR", error);
        });
    };
    ViewComponent.prototype.insert = function () {
        var _this = this;
        this.database.execSQL("INSERT INTO dict (engWorld, thaiWorld) VALUES (?,?)", ["red", "แดง"]).then(function (all_word) {
            console.log("INSERT RESULT => ", all_word);
            _this.fetch();
        }, function (error) {
            console.log("INSERT ERROR => ", error);
        });
    };
    ViewComponent.prototype.fetch = function () {
        var _this = this;
        var self = this;
        console.log("Go to ===> fetch");
        this.database.all("SELECT * FROM dict").then(function (rows) {
            console.log(rows);
            _this.word_list = rows;
            /*for(var row in rows){
                console.log("Result ==v");
            
                console.log("result all ==> " , rows[row]);//result all
                console.log("eng_word ==> " , rows[row][1]); // result eng
                console.log("thai_word ==> " , rows[row][2]); //result thai
                console.log("type word ==> " , rows[row][3]); //result thai
            }*/
            for (var i = 0; i < rows.length; i++) {
                console.log("result ==>", rows[i]);
            }
        }, function (error) {
            console.log("SELECT ERROR ", error);
        });
    };
    ViewComponent.prototype.fetch2 = function () {
        var _this = this;
        var self = this;
        console.log("Go to ===> fetch");
        this.database.all("SELECT * FROM dict").then(function (rows) {
            console.log(rows);
            _this.word_list = rows;
            /*for(var row in rows){
                console.log("Result ==v");
            
                console.log("result all ==> " , rows[row]);//result all
                console.log("eng_word ==> " , rows[row][1]); // result eng
                console.log("thai_word ==> " , rows[row][2]); //result thai
                console.log("type word ==> " , rows[row][3]); //result thai
            }*/
            for (var i = 0; i < rows.length; i++) {
                console.log("result ==>", rows[i]);
            }
            self.refeshList();
            self.pushList(rows);
            self.refeshList();
            self.pushList(rows);
        }, function (error) {
            console.log("SELECT ERROR ", error);
        });
    };
    ViewComponent.prototype.btnInsert = function () {
        console.log("click btnInsert");
        this.router.navigate(["insert"]), {
            transition: {
                name: "flip",
                dutation: 2000,
                curve: "linear"
            }
        };
        this.btnSelectRandom();
    };
    ViewComponent.prototype.btnSelect = function () {
        var _this = this;
        var search = this.word_search;
        if (search == "") {
            alert("มีช่องว่างนะไอ้โง่ .....");
        }
        else {
            console.log("Check ==> ", "Select ===> " + search);
            var temp = "%" + search + "%";
            this.database.all("SELECT * FROM dict WHERE engWorld LIKE (?) or thaiWorld LIKE (?)", [temp, temp]).then(function (rows) {
                if (rows == "") {
                    console.log("not word ===>  " + rows + "is " + search);
                    alert("ไม่มีคำว่า " + search + " ในฐานข้อมูล");
                }
                _this.word_list = rows;
                for (var row in rows) {
                    console.log("Result ==v");
                    /*for(var i=0 ; i <= rows.length ; i++ ){
                     console.log("result ==>" , rows[row][i]);
                    }*/
                    console.log("result all ==> ", rows[row]); //result all
                    console.log("eng_word ==> ", rows[row][1]); // result eng
                    console.log("thai_word ==> ", rows[row][2]); //result thai
                }
            }, function (error) {
                console.log("SELECT ERROR ", error);
            });
        }
    };
    ViewComponent.prototype.btnDelete = function () {
        console.log("Check == > ", " Delete");
        this.router.navigate(["delete"]), {};
        this.btnSelectRandom();
    };
    //  function use for listview
    ViewComponent.prototype.ngOnInit = function () {
        var self = this;
        self.getItem();
    };
    ViewComponent.prototype.onItemTap = function (args) {
        var self = this;
        var word = self.word_list2[args.index];
        console.log(JSON.stringify(word));
        var navigationExtras = {
            queryParams: {
                "words": JSON.stringify(word)
            }
        };
        this.router.navigate(["list-detail"], navigationExtras);
    };
    ViewComponent.prototype.getItem = function () {
        console.log("GET ITEM ================> ");
        var self = this;
        var temp_list;
        temp_list = self.word_list;
        for (var row in temp_list) {
            var model_item = new item_1.Item();
            model_item.id = temp_list[row][0];
            model_item.wordEng = temp_list[row][1];
            model_item.wordThai = temp_list[row][2];
            model_item.wordType = temp_list[row][3];
            model_item.wordFavorite = temp_list[row][4];
            //console.log(temp_list[row][0] +" " + temp_list[row][1] +" " + temp_list[row][2] );
            self.word_list2.push(model_item);
        }
    };
    ViewComponent.prototype.getItemSelect = function () {
        var self = this;
        var search = self.word_search;
        if (search == "") {
            alert("มีช่องว่างนะไอ้โง่ .....");
        }
        else {
            console.log("Check ==> ", "Select ===> " + search);
            var temp = search + "%";
            self.database.all("SELECT * FROM dict WHERE engWorld LIKE (?) or thaiWorld LIKE (?)", [temp, temp]).then(function (rows) {
                if (rows == "") {
                    console.log("not word ===>  " + rows + "is " + search);
                    alert("ไม่มีคำว่า " + search + " ในฐานข้อมูล");
                }
                else {
                    self.word_search = "";
                }
                self.word_list = rows;
                self.refeshList();
                self.pushList(rows);
                self.refeshList();
                self.pushList(rows);
            }, function (error) {
                console.log("SELECT ERROR ", error);
            });
        }
    };
    ViewComponent.prototype.btnSelectRandom = function () {
        //console.log("Select Random");
        var _this = this;
        this.database.all("SELECT * FROM dict ORDER BY RANDOM() LIMIT 1").then(function (rows) {
            console.log(rows);
            console.log("eng_word ==> ", rows[0][1]); // result eng
            _this.eng_rand = rows[0][1];
            console.log("thai_word ==> ", rows[0][2]); //result thai
            _this.thai_rand = rows[0][2];
            console.log("type word ==> ", rows[0][3]); //result type
            _this.type_rand = rows[0][3];
        }, function (error) {
            console.log("SELECT ERROR ", error);
        });
    };
    ViewComponent.prototype.refeshList = function () {
        var self = this;
        var delPop = self.word_list2.length;
        console.log("delpop length ==>", delPop);
        if (delPop > 0) {
            for (var i = 0; i < delPop; i++) {
                self.word_list2.pop();
            }
        }
    };
    ViewComponent.prototype.pushList = function (args) {
        var self = this;
        var rows = args;
        for (var row in rows) {
            console.log(rows[row]);
            var model_item = new item_1.Item();
            model_item.id = rows[row][0];
            model_item.wordEng = rows[row][1];
            model_item.wordThai = rows[row][2];
            model_item.wordType = rows[row][3];
            model_item.wordFavorite = rows[row][4];
            console.log(rows[row][0] + " " + rows[row][1] + " " + rows[row][2] + "");
            self.word_list2.push(model_item);
        }
    };
    return ViewComponent;
}());
ViewComponent = __decorate([
    core_1.Component({
        selector: "ns-app",
        templateUrl: "views/main.html",
    }),
    __metadata("design:paramtypes", [router_1.Router])
], ViewComponent);
exports.ViewComponent = ViewComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHNDQUFrRDtBQUNsRCwwQ0FBeUQ7QUFHekQsNkNBQTRDO0FBRzVDLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0FBUzVDLElBQWEsYUFBYTtJQWdCdEIsdUJBQTJCLE1BQWM7UUFBekMsaUJBdUNDO1FBdkMwQixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBWnpDLGFBQVEsR0FBRSxFQUFFLENBQUM7UUFDYixjQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ2YsY0FBUyxHQUFFLEVBQUUsQ0FBQztRQUVkLGdCQUFXLEdBQUUsRUFBRSxDQUFDO1FBRWhCLGNBQVMsR0FBRyxFQUFFLENBQUM7UUFDZixlQUFVLEdBQUcsRUFBRSxDQUFDO1FBUVoseUNBQXlDO1FBQ3pDLENBQUMsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxFQUFFO1lBQzVCLEVBQUUsQ0FBQyxPQUFPLENBQUMsc0xBQXNMLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxFQUFFO2dCQUN0TSxLQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztnQkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO2dCQUN6QyxnQkFBZ0I7Z0JBQ2hCLEtBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDYixFQUFFLENBQUMsT0FBTyxDQUFDLDRGQUE0RixDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsRUFBRTtvQkFDNUcsS0FBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7b0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLENBQUMsQ0FBQztvQkFDdkMsS0FBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO29CQUNyQixLQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7Z0JBQzNCLENBQUMsRUFBQyxV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QUVuQyxVQUFVLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3QixVQUFVLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsQyxVQUFVLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNuQyxVQUFVLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNuQyxVQUFVLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUV2QyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFFLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUUsRUFBRSxDQUFFLENBQUM7WUFFdkUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDakMsQ0FBQztJQUVqQixDQUFDO0lBTUosb0JBQUM7QUFBRCxDQUFDLEFBNVRGLElBNFRFO0FBNVRXLGFBQWE7SUFKekIsZ0JBQVMsQ0FBQztRQUNQLFFBQVEsRUFBRSxRQUFRO1FBQ2xCLFdBQVcsRUFBRSxpQkFBaUI7S0FDakMsQ0FBQztxQ0FpQnFDLGVBQU07R0FoQmhDLGFBQWEsQ0E0VHhCO0FBNVRXLHNDQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQge1JvdXRlciwgTmF2aWdhdGlvbkV4dHJhc30gZnJvbSBcIkBhbmd1bGFyL3JvdXRlclwiOyBcclxuaW1wb3J0IGxpc3RWaWV3TW9kdWxlID0gcmVxdWlyZShcInVpL2xpc3Qtdmlld1wiKTtcclxuXHJcbmltcG9ydCB7IEl0ZW0gfSBmcm9tIFwiLi4vbW9kZWxzL2l0ZW1zL2l0ZW1cIjtcclxuXHJcblxyXG52YXIgU3FsaXRlID0gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1zcWxpdGVcIik7XHJcblxyXG5cclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiBcIm5zLWFwcFwiLFxyXG4gICAgdGVtcGxhdGVVcmw6IFwidmlld3MvbWFpbi5odG1sXCIsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBWaWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICBwcml2YXRlIGRhdGFiYXNlIDogYW55O1xyXG5cclxuICAgIGVuZ19yYW5kID1cIlwiO1xyXG4gICAgdGhhaV9yYW5kID0gXCJcIjtcclxuICAgIHR5cGVfcmFuZCA9XCJcIjtcclxuXHJcbiAgICB3b3JkX3NlYXJjaCA9XCJcIjtcclxuICAgIFxyXG4gICAgd29yZF9saXN0ID0gW107XHJcbiAgICB3b3JkX2xpc3QyID0gW107XHJcblxyXG4gICAgXHJcbiAgICBcclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSByb3V0ZXI6IFJvdXRlciApe1xyXG5cclxuICAgICAgICBcclxuICAgICAgICAvL0NvZGUg4LiV4Lit4LiZ4LiX4Li14LmI4LmE4Lih4LmI4Lih4Li14Lit4Liw4LmE4Lij4LmA4Lil4LiiIOC5gOC4o+C4tOC5iOC4oeC4quC4o+C5ieC4suC4h+C4iOC4suC4gSAxXHJcbiAgICAgICAgKG5ldyBTcWxpdGUoXCJkaWN0cy5kYlwiKSkudGhlbihkYiA9PiB7XHJcbiAgICAgICAgICAgIGRiLmV4ZWNTUUwoXCJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBkaWN0IChpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsIGVuZ1dvcmxkIFRFWFQsIHRoYWlXb3JsZCBURVhUICx0eXBlIFRFWFQgREVGQVVMVCAnTm91bicsZmF2b3JpdGUgTlVNQkVSIERFRkFVTFQgMCAsIHNUaW1lIERBVEUgREVGQVVMVCBOdWxsIClcIikudGhlbihpZCA9PntcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YWJhc2UgPSBkYjtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ1JFQVQgVEFCTEUgPT09PiBTdWNjZXNzIFwiKTtcclxuICAgICAgICAgICAgICAgIC8vdGhpcy5pbnNlcnQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmV0Y2goKTtcclxuICAgICAgICAgICAgICAgIGRiLmV4ZWNTUUwoXCJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBGQVZPUklURSAoaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULHdvcmRfaWQgSU5URUdFUilcIikudGhlbihpZCA9PntcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFiYXNlID0gZGI7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDUkVBVEUgRkFWT1JJVEUgU3VjY2Vzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUhpc3RvcnkoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNlbGVjdFJhbmRvbSgpO1xyXG4gICAgICAgICAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBUQUJMRSBGQVZPUklURSBFUlJPUlwiICwgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ1JFQVRFIFRBQkxFIEVSUk9SXCIgLCBlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApICAgXHJcbiAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJPUEVOIERCIEVSUk9SXCIgLCBlcnJvcik7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy/guYDguKPguLXguKLguIHguYPguIrguYkgZGF0YWJhc2Ug4LiX4Li14LmI4Lih4Li14Lit4Lii4Li54LmI4LmB4Lil4LmJ4Lin4LiK4Li34LmI4LitIGRpY3RzLmRiXHJcbiAgICAgICAgLypuZXcgU3FsaXRlKFwiZGljdHMuZGJcIikudGhlbihkYiA9PntcclxuICAgICAgICAgICAgdGhpcy5kYXRhYmFzZSA9IGRiO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk9wZW4gZGF0YWJhc2UgU3VjY2Vzc1wiKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk9wZW4gREIgRVJST1JcIiAsIGVycm9yKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICovXHJcblxyXG4gICAgICAgIC8vdGhpcy5idG5TZWxlY3RSYW5kb20oKTtcclxuICAgICAgICAvL3RoaXMuaXRlbXMgPSBuZXcgSXRlbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjcmVhdGVIaXN0b3J5KCl7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZS5leGVjU1FMKFwiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgSElTVE9SWSAoaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULHdvcmRfaWQgSU5URUdFUiAsc1RpbWUgREFURSlcIikudGhlbihpZCA9PntcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFiYXNlID0gdGhpcy5kYXRhYmFzZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBISVNUT1JZIFN1Y2Nlc3NcIik7XHJcbiAgICAgICAgICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ1JFQVRFIFRBQkxFIEhJU1RPUlkgRVJST1JcIiAsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBcclxuXHJcblxyXG5cclxuICAgIHB1YmxpYyBpbnNlcnQoKXtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlLmV4ZWNTUUwoXCJJTlNFUlQgSU5UTyBkaWN0IChlbmdXb3JsZCwgdGhhaVdvcmxkKSBWQUxVRVMgKD8sPylcIiwgW1wicmVkXCIgLFwi4LmB4LiU4LiHXCJdKS50aGVuKGFsbF93b3JkID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSU5TRVJUIFJFU1VMVCA9PiBcIiAsIGFsbF93b3JkICApO1xyXG4gICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMuZmV0Y2goKTtcclxuICAgICAgICAgICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIklOU0VSVCBFUlJPUiA9PiBcIiAsIGVycm9yKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGZldGNoKCl7XHJcblxyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkdvIHRvID09PT4gZmV0Y2hcIik7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZS5hbGwoXCJTRUxFQ1QgKiBGUk9NIGRpY3RcIikudGhlbihyb3dzID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyb3dzKTtcclxuICAgICAgICAgICAgdGhpcy53b3JkX2xpc3QgPSByb3dzO1xyXG4gICAgICAgICAgICAvKmZvcih2YXIgcm93IGluIHJvd3Mpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXN1bHQgPT12XCIpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzdWx0IGFsbCA9PT4gXCIgLCByb3dzW3Jvd10pOy8vcmVzdWx0IGFsbFxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbmdfd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bMV0pOyAvLyByZXN1bHQgZW5nXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRoYWlfd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bMl0pOyAvL3Jlc3VsdCB0aGFpXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInR5cGUgd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bM10pOyAvL3Jlc3VsdCB0aGFpXHJcbiAgICAgICAgICAgIH0qL1xyXG4gICAgICAgICAgICBmb3IodmFyIGk9MCA7IGkgPCByb3dzLmxlbmd0aCA7IGkrKyApe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzdWx0ID09PlwiICwgcm93c1tpXSk7IFxyXG4gICAgICAgICAgICAgICAgfSAgICBcclxuICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBFUlJPUiBcIiAsIGVycm9yKTtcclxuICAgICAgICB9KSAgXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBmZXRjaDIoKXtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJHbyB0byA9PT0+IGZldGNoXCIpO1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2UuYWxsKFwiU0VMRUNUICogRlJPTSBkaWN0XCIpLnRoZW4ocm93cyA9PntcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocm93cyk7XHJcbiAgICAgICAgICAgIHRoaXMud29yZF9saXN0ID0gcm93cztcclxuICAgICAgICAgICAgLypmb3IodmFyIHJvdyBpbiByb3dzKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzdWx0ID09dlwiKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdCBhbGwgPT0+IFwiICwgcm93c1tyb3ddKTsvL3Jlc3VsdCBhbGxcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZW5nX3dvcmQgPT0+IFwiICwgcm93c1tyb3ddWzFdKTsgLy8gcmVzdWx0IGVuZ1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0aGFpX3dvcmQgPT0+IFwiICwgcm93c1tyb3ddWzJdKTsgLy9yZXN1bHQgdGhhaVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0eXBlIHdvcmQgPT0+IFwiICwgcm93c1tyb3ddWzNdKTsgLy9yZXN1bHQgdGhhaVxyXG4gICAgICAgICAgICB9Ki9cclxuICAgICAgICAgICAgZm9yKHZhciBpPTAgOyBpIDwgcm93cy5sZW5ndGggOyBpKysgKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdCA9PT5cIiAsIHJvd3NbaV0pOyBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5yZWZlc2hMaXN0KCk7XHJcbiAgICAgICAgICAgIHNlbGYucHVzaExpc3Qocm93cyk7XHJcbiAgICAgICAgICAgIHNlbGYucmVmZXNoTGlzdCgpO1xyXG4gICAgICAgICAgICBzZWxmLnB1c2hMaXN0KHJvd3MpOyAgIFxyXG4gICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU0VMRUNUIEVSUk9SIFwiICwgZXJyb3IpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgYnRuSW5zZXJ0KCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJjbGljayBidG5JbnNlcnRcIik7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wiaW5zZXJ0XCJdKSx7XHJcbiAgICAgICAgICAgIHRyYW5zaXRpb246IHtcclxuICAgICAgICAgICAgICAgIG5hbWUgOiBcImZsaXBcIiAsXHJcbiAgICAgICAgICAgICAgICBkdXRhdGlvbjogMjAwMCxcclxuICAgICAgICAgICAgICAgIGN1cnZlOiBcImxpbmVhclwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5idG5TZWxlY3RSYW5kb20oKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBidG5TZWxlY3QoKXtcclxuICAgICAgICB2YXIgc2VhcmNoID0gdGhpcy53b3JkX3NlYXJjaDtcclxuICAgICAgICBpZiAoc2VhcmNoID09IFwiXCIpe1xyXG4gICAgICAgICAgICBhbGVydChcIuC4oeC4teC4iuC5iOC4reC4h+C4p+C5iOC4suC4h+C4meC4sOC5hOC4reC5ieC5guC4h+C5iCAuLi4uLlwiKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaGVjayA9PT4gXCIgLCBcIlNlbGVjdCA9PT0+IFwiICsgc2VhcmNoKTtcclxuICAgICAgICAgICAgIHZhciB0ZW1wID0gXCIlXCIrc2VhcmNoK1wiJVwiO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5kYXRhYmFzZS5hbGwoXCJTRUxFQ1QgKiBGUk9NIGRpY3QgV0hFUkUgZW5nV29ybGQgTElLRSAoPykgb3IgdGhhaVdvcmxkIExJS0UgKD8pXCIsW3RlbXAsdGVtcF0gKS50aGVuKHJvd3MgPT57XHJcbiAgICAgICAgICAgICAgICBpZihyb3dzID09XCJcIil7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJub3Qgd29yZCA9PT0+ICBcIiArIHJvd3MgKyBcImlzIFwiICsgc2VhcmNoKTtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuC5hOC4oeC5iOC4oeC4teC4hOC4s+C4p+C5iOC4siBcIiArIHNlYXJjaCArIFwiIOC5g+C4meC4kOC4suC4meC4guC5ieC4reC4oeC4ueC4pVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMud29yZF9saXN0ID0gcm93cztcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgcm93IGluIHJvd3Mpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzdWx0ID09dlwiKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvKmZvcih2YXIgaT0wIDsgaSA8PSByb3dzLmxlbmd0aCA7IGkrKyApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXN1bHQgPT0+XCIgLCByb3dzW3Jvd11baV0pOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSovXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXN1bHQgYWxsID09PiBcIiAsIHJvd3Nbcm93XSk7Ly9yZXN1bHQgYWxsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbmdfd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bMV0pOyAvLyByZXN1bHQgZW5nXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0aGFpX3dvcmQgPT0+IFwiICwgcm93c1tyb3ddWzJdKTsgLy9yZXN1bHQgdGhhaVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTRUxFQ1QgRVJST1IgXCIgLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGJ0bkRlbGV0ZSgpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2sgPT0gPiBcIiAsIFwiIERlbGV0ZVwiKTtcclxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJkZWxldGVcIl0pLHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYnRuU2VsZWN0UmFuZG9tKCk7XHJcbiAgICAgICAgIFxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgLy8gIGZ1bmN0aW9uIHVzZSBmb3IgbGlzdHZpZXdcclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuXHRcdHNlbGYuZ2V0SXRlbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uSXRlbVRhcChhcmdzKSB7XHJcblx0XHRsZXQgc2VsZiA9IHRoaXM7XHJcblx0XHRsZXQgd29yZCA9IHNlbGYud29yZF9saXN0MlthcmdzLmluZGV4XTtcclxuXHRcdFxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh3b3JkKSApO1xyXG4gICAgICAgIGxldCBuYXZpZ2F0aW9uRXh0cmFzOiBOYXZpZ2F0aW9uRXh0cmFzID0ge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgXCJ3b3Jkc1wiOiBKU09OLnN0cmluZ2lmeSh3b3JkKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJsaXN0LWRldGFpbFwiXSwgbmF2aWdhdGlvbkV4dHJhcyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SXRlbSgpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiR0VUIElURU0gPT09PT09PT09PT09PT09PT4gXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgdGVtcF9saXN0IDogQXJyYXk8YW55PjtcclxuICAgICAgICB0ZW1wX2xpc3QgPSBzZWxmLndvcmRfbGlzdDtcclxuICAgICAgICBcclxuICAgICAgICBmb3IodmFyIHJvdyBpbiB0ZW1wX2xpc3Qpe1xyXG4gICAgICAgICAgICBsZXQgbW9kZWxfaXRlbSA6IEl0ZW0gPSBuZXcgSXRlbSgpO1xyXG5cclxuICAgICAgICAgICAgbW9kZWxfaXRlbS5pZCA9IHRlbXBfbGlzdFtyb3ddWzBdO1xyXG4gICAgICAgICAgICBtb2RlbF9pdGVtLndvcmRFbmcgPSB0ZW1wX2xpc3Rbcm93XVsxXTtcclxuICAgICAgICAgICAgbW9kZWxfaXRlbS53b3JkVGhhaSA9IHRlbXBfbGlzdFtyb3ddWzJdO1xyXG4gICAgICAgICAgICBtb2RlbF9pdGVtLndvcmRUeXBlID0gdGVtcF9saXN0W3Jvd11bM107XHJcbiAgICAgICAgICAgIG1vZGVsX2l0ZW0ud29yZEZhdm9yaXRlID0gdGVtcF9saXN0W3Jvd11bNF07XHJcblxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRlbXBfbGlzdFtyb3ddWzBdICtcIiBcIiArIHRlbXBfbGlzdFtyb3ddWzFdICtcIiBcIiArIHRlbXBfbGlzdFtyb3ddWzJdICk7XHJcblxyXG4gICAgICAgICAgICBzZWxmLndvcmRfbGlzdDIucHVzaChtb2RlbF9pdGVtKTtcclxuICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldEl0ZW1TZWxlY3QoKXtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHNlYXJjaCA9IHNlbGYud29yZF9zZWFyY2g7XHJcbiAgICAgICAgaWYgKHNlYXJjaCA9PSBcIlwiKXtcclxuICAgICAgICAgICAgYWxlcnQoXCLguKHguLXguIrguYjguK3guIfguKfguYjguLLguIfguJnguLDguYTguK3guYnguYLguIfguYggLi4uLi5cIik7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2sgPT0+IFwiICwgXCJTZWxlY3QgPT09PiBcIiArIHNlYXJjaCk7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gc2VhcmNoK1wiJVwiO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc2VsZi5kYXRhYmFzZS5hbGwoXCJTRUxFQ1QgKiBGUk9NIGRpY3QgV0hFUkUgZW5nV29ybGQgTElLRSAoPykgb3IgdGhhaVdvcmxkIExJS0UgKD8pXCIsW3RlbXAsdGVtcF0gKS50aGVuKHJvd3MgPT57XHJcbiAgICAgICAgICAgICAgICBpZihyb3dzID09XCJcIil7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJub3Qgd29yZCA9PT0+ICBcIiArIHJvd3MgKyBcImlzIFwiICsgc2VhcmNoKTtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuC5hOC4oeC5iOC4oeC4teC4hOC4s+C4p+C5iOC4siBcIiArIHNlYXJjaCArIFwiIOC5g+C4meC4kOC4suC4meC4guC5ieC4reC4oeC4ueC4pVwiKTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYud29yZF9zZWFyY2ggPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBzZWxmLndvcmRfbGlzdCA9IHJvd3M7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlZmVzaExpc3QoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucHVzaExpc3Qocm93cyk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlZmVzaExpc3QoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucHVzaExpc3Qocm93cyk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBFUlJPUiBcIiAsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgYnRuU2VsZWN0UmFuZG9tKCl7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIlNlbGVjdCBSYW5kb21cIik7XHJcblxyXG4gICAgICAgIHRoaXMuZGF0YWJhc2UuYWxsKFwiU0VMRUNUICogRlJPTSBkaWN0IE9SREVSIEJZIFJBTkRPTSgpIExJTUlUIDFcIikudGhlbihyb3dzID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyb3dzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZW5nX3dvcmQgPT0+IFwiICwgcm93c1swXVsxXSk7IC8vIHJlc3VsdCBlbmdcclxuICAgICAgICAgICAgdGhpcy5lbmdfcmFuZCA9IHJvd3NbMF1bMV07XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGhhaV93b3JkID09PiBcIiAsIHJvd3NbMF1bMl0pOyAvL3Jlc3VsdCB0aGFpXHJcbiAgICAgICAgICAgIHRoaXMudGhhaV9yYW5kID0gcm93c1swXVsyXTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0eXBlIHdvcmQgPT0+IFwiICwgcm93c1swXVszXSk7IC8vcmVzdWx0IHR5cGVcclxuICAgICAgICAgICAgdGhpcy50eXBlX3JhbmQgPSByb3dzWzBdWzNdO1xyXG4gICAgICAgIFxyXG5cclxuICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBFUlJPUiBcIiAsIGVycm9yKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICByZWZlc2hMaXN0KCl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBkZWxQb3AgPSBzZWxmLndvcmRfbGlzdDIubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbHBvcCBsZW5ndGggPT0+XCIgLCBkZWxQb3ApO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBpZihkZWxQb3AgPjAgKXtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwIDsgaSA8IGRlbFBvcCA7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi53b3JkX2xpc3QyLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVzaExpc3QoYXJncyl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGxldCByb3dzID0gYXJncztcclxuXHJcblxyXG4gICAgICAgIGZvcih2YXIgcm93IGluIHJvd3Mpe1xyXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyb3dzW3Jvd10pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgbW9kZWxfaXRlbSA6IEl0ZW0gPSBuZXcgSXRlbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBtb2RlbF9pdGVtLmlkID0gcm93c1tyb3ddWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsX2l0ZW0ud29yZEVuZyA9IHJvd3Nbcm93XVsxXTtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbF9pdGVtLndvcmRUaGFpID0gcm93c1tyb3ddWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsX2l0ZW0ud29yZFR5cGUgPSByb3dzW3Jvd11bM107XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxfaXRlbS53b3JkRmF2b3JpdGUgPSByb3dzW3Jvd11bNF07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJvd3Nbcm93XVswXSArXCIgXCIgKyByb3dzW3Jvd11bMV0gK1wiIFwiICsgcm93c1tyb3ddWzJdICtcIlwiICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYud29yZF9saXN0Mi5wdXNoKG1vZGVsX2l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBcclxuXHJcbiAgICBcclxuXHJcblxyXG4gfVxyXG4iXX0=