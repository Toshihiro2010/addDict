"use strict";
var core_1 = require("@angular/core");
var router_1 = require("@angular/router");
var items_word_1 = require("../models/items/items_word");
var myDB_1 = require("../models/myDb/myDB");
var application = require("application");
var application_1 = require("application");
var platform_1 = require("platform");
var Sqlite = require("nativescript-sqlite");
var fs = require("file-system");
var ViewComponent = (function () {
    function ViewComponent(router) {
        this.router = router;
        this.db_word = []; //เก็บไฟล์ ในรูปของ object ในโฟลเดอร์ file/database 
        this.word_rand = ""; //word eng Random show on layout
        this.mean_rand = ""; //word thai Random show on layout
        this.type_rand = ""; //word type Random show on layout
        this.word_list2 = []; //list show on layout
        this.word_search = ""; //ngModule input word search-
        this.word_list = []; //list sql temp 
        this.word_sql = ""; //output on sql
        this.viewCheck = 0; // เช็คว่า เป็นส่วนไหน 0-random , 1-Search , 2-Facvortie , 3-History
        var self = this;
        //Code ตอนที่ไม่มีอะไรเลย เริ่มสร้างจาก 1
        (new Sqlite("dicts.db")).then(function (db) {
            self.database = db;
            self.createHistory();
            self.createMyUser();
            self.createFavorite();
        }, function (error) {
            console.log("OPEN DB ERROR", error);
        });
        self.myDb();
        new Sqlite(self.my_db_path).then(function (db) {
            self.my_db = db;
            self.btnSelectRandom();
            console.log("Open database Success");
        }, function (error) {
            console.log("Open DB ERROR", error);
        });
    }
    //  function use for listview
    ViewComponent.prototype.ngOnInit = function () {
        var self = this;
        console.log('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
        //self.getItem();
        //self.pushList(self.word_list);
        if (!platform_1.isAndroid) {
            return;
        }
        application.android.on(application_1.AndroidApplication.activityBackPressedEvent, function (data) {
            console.log('AndroidApplication.activityBackPressedEvent');
            //this.fetch2();
        });
    };
    ViewComponent.prototype.myDb = function () {
        var self = this;
        console.log("in => self.mydb");
        var doc = fs.knownFolders.documents();
        var my_path = doc.getFolder("database");
        console.log(JSON.stringify(my_path));
        var temp = my_path.getEntitiesSync();
        console.log("temp => ", JSON.stringify(temp));
        for (var i in temp) {
            //console.log("i" , JSON.stringify(temp[i]));
            var model_db = new myDB_1.MyDatabase();
            console.log("i", temp[i].name);
            console.log("i", temp[i].extension);
            if (temp[i].extension == ".db") {
                //let temp2 = [temp[i].name , temp[i].path];
                model_db.name = temp[i].name;
                model_db.path = temp[i].path;
                //let temp2 = [1][1];;
                self.db_word.push(model_db);
            }
        }
        if (self.db_word.length == 0) {
            console.log("Not DATABASE");
            console.log(self.db_word.length);
        }
        else if (self.db_word.length == 1) {
            console.log(self.db_word.length);
            self.my_db_path = self.db_word[0].path;
            console.log("my_db => " + self.my_db_path);
        }
        else if (self.db_word.length > 1) {
            console.log(self.db_word.length);
            for (var i = 0; i < self.db_word.length; i++) {
                if (self.db_word[i].name == "EngToTha.db") {
                    self.my_db_path = self.db_word[i].path;
                }
                if (i = self.db_word.length - 1) {
                    if (self.my_db_path == "") {
                        self.my_db_path = self.db_word[0].path;
                    }
                }
            }
        }
    };
    ViewComponent.prototype.ngAfterViewInit = function () {
        console.log("ng==========> AfterViewInit");
    };
    ViewComponent.prototype.createHistory = function () {
        var self = this;
        self.database.execSQL("CREATE TABLE IF NOT EXISTS HISTORY (id INTEGER PRIMARY KEY AUTOINCREMENT,word_id INTEGER ,sTime DATE)").then(function (id) {
            self.database = self.database;
            console.log("CREATE HISTORY Success");
        }, function (error) {
            console.log("CREATE TABLE HISTORY ERROR", error);
        });
    };
    ViewComponent.prototype.createFavorite = function () {
        var self = this;
        self.database.execSQL("CREATE TABLE IF NOT EXISTS FAVORITE (id INTEGER PRIMARY KEY AUTOINCREMENT,word_id INTEGER )").then(function (id) {
            self.database = self.database;
            console.log("CREATE FAVORITE Success");
        }, function (error) {
            console.log("CREATE TABLE FAVORITE ERROR", error);
        });
    };
    ViewComponent.prototype.createMyUser = function () {
        var self = this;
        self.database.execSQL("CREATE TABLE IF NOT EXISTS USERS (id INTEGER PRIMARY KEY AUTOINCREMENT,username TEXT , name TEXT , status INTEGER , login INTEGER DEFAULT 0 )").then(function (id) {
            self.database = self.database;
            console.log("CREATE USERS Success");
        }, function (error) {
            console.log("CREATE TABLE USERS ERROR", error);
        });
    };
    ViewComponent.prototype.fetch2 = function () {
        var _this = this;
        var self = this;
        self.viewCheck = 1;
        console.log("Go to ===> fetch 2");
        this.my_db.all("SELECT dict_no , dict_search , dict_meaning FROM words WHERE dict_no > 400 LIMit 10").then(function (rows) {
            //console.log(rows);
            _this.word_list = rows;
            for (var i = 0; i < rows.length; i++) {
            }
            self.refeshList();
            self.pushList(rows);
        }, function (error) {
            console.log("SELECT ERROR ", error);
        });
    };
    ViewComponent.prototype.btnInsert = function () {
        console.log("click btnInsert");
        this.router.navigate(["insert"]), {
            transition: {
                name: "flip",
                dutation: 2000,
                curve: "linear"
            }
        };
        this.btnSelectRandom();
    };
    ViewComponent.prototype.btnSelect = function () {
        var self = this;
        var search = self.word_search;
        if (search == "") {
            alert("มีช่องว่างนะไอ้โง่ .....");
        }
        else {
            console.log("Check ==> ", "Select ===> " + search);
            var temp = "%" + search + "%";
            self.my_db.all("SELECT dict_no , dict_search , dict_meaning FROM words WHERE dict_search LIKE (?)", [temp]).then(function (rows) {
                if (rows == "") {
                    console.log("not word ===>  " + rows + "is " + search);
                    alert("ไม่มีคำว่า " + search + " ในฐานข้อมูล");
                }
                self.word_list = rows;
                for (var row in rows) {
                    console.log("Result ==v");
                    console.log("result all ==> ", rows[row]); //result all
                    console.log("eng_word ==> ", rows[row][1]); // result eng
                    console.log("thai_word ==> ", rows[row][2]);
                }
            }, function (error) {
                console.log("SELECT ERROR ", error);
            });
        }
    };
    ViewComponent.prototype.btnDelete = function () {
        console.log("Check == > ", " Delete");
        this.router.navigate(["delete"]), {};
        this.btnSelectRandom();
    };
    ViewComponent.prototype.getItem = function () {
        console.log("GET ITEM ================> ");
        var self = this;
        var temp_list;
        temp_list = self.word_list;
        for (var row in temp_list) {
            var model_word = new items_word_1.WordItem();
            model_word.id = temp_list[row][0];
            model_word.dict_search = temp_list[row][1];
            model_word.dict_meaning = temp_list[row][2];
            self.word_list2.push(model_word);
        }
    };
    ViewComponent.prototype.getItemSelect = function () {
        var self = this;
        self.viewCheck = 1;
        var search = self.word_search;
        if (search == "") {
            self.btnSelectRandom();
            alert("มีช่องว่างนะไอ้โง่ .....");
        }
        else {
            console.log("Check ==> ", "Select ===> " + search);
            var temp = search + "%";
            self.my_db.all("SELECT dict_no , dict_search , dict_meaning FROM words WHERE dict_search LIKE (?)", [temp]).then(function (rows) {
                if (rows == "") {
                    console.log("not word ===>  " + rows + "is " + search);
                    alert("ไม่มีคำว่า " + search + " ในฐานข้อมูล");
                }
                else {
                    self.word_search = "";
                }
                self.word_sql = rows;
                self.refeshList();
                self.pushList(rows);
                //self.refeshList();
                //self.pushList(rows);
            }, function (error) {
                console.log("SELECT ERROR ", error);
            });
        }
    };
    // FAVORiTE AND HISTORY NO USE
    ViewComponent.prototype.getItemFavorite = function () {
        var self = this;
        self.viewCheck = 1;
        var strSQL = "SELECT word_id FROM FAVORITE";
        self.database.all(strSQL).then(function (result) {
            self.word_sql = result;
            self.refeshList();
            self.pushList(self.word_sql);
        }, function (error) {
            console.log("SELECT Favoirite Error => ", error);
        });
    };
    ViewComponent.prototype.getItemHistory = function () {
        var self = this;
        self.viewCheck = 1;
        var strSQL = "SELECT h.word_id , d.engWorld , d.thaiWorld , d.type , d.favorite FROM HISTORY h join dict d on h.word_id = d.id ORDER BY h.id DESC";
        self.database.all(strSQL).then(function (result) {
            self.word_sql = result;
            self.refeshList();
            self.pushList(self.word_sql);
        }, function (error) {
            console.log("SELECT History Error => ", error);
        });
    };
    ViewComponent.prototype.btnSelectRandom = function () {
        //console.log("Select Random");
        var self = this;
        self.viewCheck = 0;
        self.refeshList();
        self.my_db.all("SELECT dict_no , dict_search , dict_meaning FROM words WHERE dict_no > 400 ORDER BY RANDOM() LIMIT 1").then(function (rows) {
            console.log(rows);
            console.log("eng_word ==> ", rows[0][1]); // result word
            self.word_rand = rows[0][1];
            console.log("thai_word ==> ", rows[0][2]); //result mean word
            self.mean_rand = rows[0][2];
        }, function (error) {
            console.log("SELECT ERROR ", error);
        });
    };
    ViewComponent.prototype.refeshList = function () {
        var self = this;
        var delPop = self.word_list2.length;
        console.log("delpop length ==>", delPop);
        if (delPop > 0) {
            for (var i = 0; i < delPop; i++) {
                self.word_list2.pop();
            }
        }
    };
    ViewComponent.prototype.pushList = function (args) {
        var self = this;
        var rows = args;
        for (var row in rows) {
            var model_word = new items_word_1.WordItem();
            model_word.id = rows[row][0];
            model_word.dict_search = rows[row][1];
            model_word.dict_meaning = rows[row][2];
            self.word_list2.push(model_word);
        }
    };
    ViewComponent.prototype.onItemTap = function (args) {
        var self = this;
        var word = self.word_list2[args.index];
        var navigationExtras = {
            queryParams: {
                "words": JSON.stringify(word)
            }
        };
        this.router.navigate(["list-detail"], navigationExtras);
    };
    ViewComponent.prototype.onSetting = function () {
        console.log("Check == > ", " onSetting");
        this.router.navigate(["setting"]), {};
    };
    return ViewComponent;
}());
ViewComponent = __decorate([
    core_1.Component({
        selector: "ns-app",
        templateUrl: "views/main.html",
    }),
    __metadata("design:paramtypes", [router_1.Router])
], ViewComponent);
exports.ViewComponent = ViewComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHNDQUFvRTtBQUNwRSwwQ0FBMkQ7QUFJM0QseURBQXNEO0FBQ3RELDRDQUFnRDtBQUdoRCx5Q0FBMkM7QUFDM0MsMkNBQXNGO0FBQ3RGLHFDQUFxQztBQUVyQyxJQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQztBQUM1QyxJQUFJLEVBQUUsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7QUFNaEMsSUFBYSxhQUFhO0lBeUJ0Qix1QkFBMkIsTUFBYztRQUFkLFdBQU0sR0FBTixNQUFNLENBQVE7UUF0QmpDLFlBQU8sR0FBRyxFQUFFLENBQUUsQ0FBRSxvREFBb0Q7UUFNNUUsY0FBUyxHQUFFLEVBQUUsQ0FBQyxDQUFHLGdDQUFnQztRQUNqRCxjQUFTLEdBQUcsRUFBRSxDQUFDLENBQUMsaUNBQWlDO1FBQ2pELGNBQVMsR0FBRSxFQUFFLENBQUMsQ0FBRSxpQ0FBaUM7UUFDakQsZUFBVSxHQUFHLEVBQUUsQ0FBQyxDQUFJLHFCQUFxQjtRQUV6QyxnQkFBVyxHQUFFLEVBQUUsQ0FBQyxDQUFLLDZCQUE2QjtRQUVsRCxjQUFTLEdBQUcsRUFBRSxDQUFDLENBQUssZ0JBQWdCO1FBQ3BDLGFBQVEsR0FBRyxFQUFFLENBQUMsQ0FBRyxlQUFlO1FBR3hCLGNBQVMsR0FBRyxDQUFDLENBQUMsQ0FBQyxvRUFBb0U7UUFNdkYsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBRWhCLHlDQUF5QztRQUN6QyxDQUFDLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsRUFBRTtZQUN4QixJQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztZQUVuQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDckIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ3BCLElBQUksQ0FB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VUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUVqQyxJQUFJLGdCQUFnQixHQUFxQjtZQUNyQyxXQUFXLEVBQUU7Z0JBQ1QsT0FBTyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDO2FBQ2hDO1NBQ0osQ0FBQztRQUNGLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsYUFBYSxDQUFDLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBRUQsaUNBQVMsR0FBVDtRQUNJLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFHLFlBQVksQ0FBQyxDQUFDO1FBQzFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBQyxFQUVqQyxDQUFBO0lBRUwsQ0FBQztJQUVKLG9CQUFDO0FBQUQsQ0FBQyxBQXJZRixJQXFZRTtBQXJZVyxhQUFhO0lBSnpCLGdCQUFTLENBQUM7UUFDUCxRQUFRLEVBQUUsUUFBUTtRQUNsQixXQUFXLEVBQUUsaUJBQWlCO0tBQ2pDLENBQUM7cUNBMEJxQyxlQUFNO0dBekJoQyxhQUFhLENBcVl4QjtBQXJZVyxzQ0FBYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0ICAsIEFmdGVyVmlld0luaXQgIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgUm91dGVyLCBOYXZpZ2F0aW9uRXh0cmFzIH0gZnJvbSBcIkBhbmd1bGFyL3JvdXRlclwiOyBcclxuaW1wb3J0IGxpc3RWaWV3TW9kdWxlID0gcmVxdWlyZShcInVpL2xpc3Qtdmlld1wiKTtcclxuXHJcbmltcG9ydCB7IEl0ZW0gfSBmcm9tIFwiLi4vbW9kZWxzL2l0ZW1zL2l0ZW1cIjtcclxuaW1wb3J0IHsgV29yZEl0ZW0gfSBmcm9tIFwiLi4vbW9kZWxzL2l0ZW1zL2l0ZW1zX3dvcmRcIjtcclxuaW1wb3J0IHsgTXlEYXRhYmFzZSB9IGZyb20gXCIuLi9tb2RlbHMvbXlEYi9teURCXCJcclxuXHJcbmltcG9ydCB7IFJvdXRlckV4dGVuc2lvbnMgfSBmcm9tIFwibmF0aXZlc2NyaXB0LWFuZ3VsYXJcIjtcclxuaW1wb3J0ICogYXMgYXBwbGljYXRpb24gZnJvbSBcImFwcGxpY2F0aW9uXCI7XHJcbmltcG9ydCB7IEFuZHJvaWRBcHBsaWNhdGlvbiwgQW5kcm9pZEFjdGl2aXR5QmFja1ByZXNzZWRFdmVudERhdGEgfSBmcm9tIFwiYXBwbGljYXRpb25cIjtcclxuaW1wb3J0IHsgaXNBbmRyb2lkIH0gZnJvbSBcInBsYXRmb3JtXCI7XHJcblxyXG52YXIgU3FsaXRlID0gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1zcWxpdGVcIik7XHJcbnZhciBmcyA9IHJlcXVpcmUoXCJmaWxlLXN5c3RlbVwiKTtcclxuICAgIFxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiBcIm5zLWFwcFwiLFxyXG4gICAgdGVtcGxhdGVVcmw6IFwidmlld3MvbWFpbi5odG1sXCIsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBWaWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0ICwgQWZ0ZXJWaWV3SW5pdCB7XHJcblxyXG4gICAgcHJpdmF0ZSBkYXRhYmFzZSA6IGFueTtcclxuICAgIHByaXZhdGUgZGJfd29yZCA9IFtdIDsgIC8v4LmA4LiB4LmH4Lia4LmE4Lif4Lil4LmMIOC5g+C4meC4o+C4ueC4m+C4guC4reC4hyBvYmplY3Qg4LmD4LiZ4LmC4Lif4Lil4LmA4LiU4Lit4Lij4LmMIGZpbGUvZGF0YWJhc2UgXHJcbiAgICBwcml2YXRlIG15X2RiOyAgLy/guYDguIHguYfguJogcGF0aCBmaWxlIERhdGFiYXNlXHJcbiAgICBwcml2YXRlIG15X2RiX3BhdGg7ICAvL+C5gOC4geC5h+C4miBwYXRoIGZpbGUgRGF0YWJhc2VcclxuIFxyXG5cclxuXHJcbiAgICB3b3JkX3JhbmQgPVwiXCI7ICAgLy93b3JkIGVuZyBSYW5kb20gc2hvdyBvbiBsYXlvdXRcclxuICAgIG1lYW5fcmFuZCA9IFwiXCI7IC8vd29yZCB0aGFpIFJhbmRvbSBzaG93IG9uIGxheW91dFxyXG4gICAgdHlwZV9yYW5kID1cIlwiOyAgLy93b3JkIHR5cGUgUmFuZG9tIHNob3cgb24gbGF5b3V0XHJcbiAgICB3b3JkX2xpc3QyID0gW107ICAgIC8vbGlzdCBzaG93IG9uIGxheW91dFxyXG5cclxuICAgIHdvcmRfc2VhcmNoID1cIlwiOyAgICAgLy9uZ01vZHVsZSBpbnB1dCB3b3JkIHNlYXJjaC1cclxuICAgIFxyXG4gICAgd29yZF9saXN0ID0gW107ICAgICAvL2xpc3Qgc3FsIHRlbXAgXHJcbiAgICB3b3JkX3NxbCA9IFwiXCI7ICAgLy9vdXRwdXQgb24gc3FsXHJcblxyXG5cclxuICAgIHByaXZhdGUgdmlld0NoZWNrID0gMDsgLy8g4LmA4LiK4LmH4LiE4Lin4LmI4LiyIOC5gOC4m+C5h+C4meC4quC5iOC4p+C4meC5hOC4q+C4mSAwLXJhbmRvbSAsIDEtU2VhcmNoICwgMi1GYWN2b3J0aWUgLCAzLUhpc3RvcnlcclxuXHJcbiAgICBcclxuICAgIFxyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvdXRlcjogUm91dGVyICl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICAvL0NvZGUg4LiV4Lit4LiZ4LiX4Li14LmI4LmE4Lih4LmI4Lih4Li14Lit4Liw4LmE4Lij4LmA4Lil4LiiIOC5gOC4o+C4tOC5iOC4oeC4quC4o+C5ieC4suC4h+C4iOC4suC4gSAxXHJcbiAgICAgICAgKG5ldyBTcWxpdGUoXCJkaWN0cy5kYlwiKSkudGhlbihkYiA9PiB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRhdGFiYXNlID0gZGI7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBzZWxmLmNyZWF0ZUhpc3RvcnkoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuY3JlYXRlTXlVc2VyKCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNyZWF0ZUZhdm9yaXRlKCk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk9QRU4gREIgRVJST1JcIiAsIGVycm9yKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBzZWxmLm15RGIoKTtcclxuXHJcbiAgICAgICAgbmV3IFNxbGl0ZShzZWxmLm15X2RiX3BhdGgpLnRoZW4oZGIgPT57XHJcbiAgICAgICAgICAgIHNlbGYubXlfZGIgPSBkYjtcclxuICAgICAgICAgICAgc2VsZi5idG5TZWxlY3RSYW5kb20oKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJPcGVuIGRhdGFiYXNlIFN1Y2Nlc3NcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiT3BlbiBEQiBFUlJPUlwiICwgZXJyb3IpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIFxyXG5cclxuICAgIC8vICBmdW5jdGlvbiB1c2UgZm9yIGxpc3R2aWV3XHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2FhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYScpO1xyXG5cdFx0Ly9zZWxmLmdldEl0ZW0oKTtcclxuICAgICAgICAvL3NlbGYucHVzaExpc3Qoc2VsZi53b3JkX2xpc3QpO1xyXG4gICAgICAgIGlmICghaXNBbmRyb2lkKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFwcGxpY2F0aW9uLmFuZHJvaWQub24oQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5QmFja1ByZXNzZWRFdmVudCwgKGRhdGE6IEFuZHJvaWRBY3Rpdml0eUJhY2tQcmVzc2VkRXZlbnREYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlCYWNrUHJlc3NlZEV2ZW50Jyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5mZXRjaDIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBteURiKCl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiaW4gPT4gc2VsZi5teWRiXCIgKTtcclxuICAgICAgICBsZXQgZG9jID0gZnMua25vd25Gb2xkZXJzLmRvY3VtZW50cygpO1xyXG4gICAgICAgIGxldCBteV9wYXRoID0gZG9jLmdldEZvbGRlcihcImRhdGFiYXNlXCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KG15X3BhdGgpKTtcclxuXHJcbiAgICAgICAgbGV0IHRlbXAgPSBteV9wYXRoLmdldEVudGl0aWVzU3luYygpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwidGVtcCA9PiBcIiAsIEpTT04uc3RyaW5naWZ5KHRlbXApKTtcclxuICAgICAgICBmb3IobGV0IGkgaW4gdGVtcCl7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJpXCIgLCBKU09OLnN0cmluZ2lmeSh0ZW1wW2ldKSk7XHJcbiAgICAgICAgICAgIGxldCBtb2RlbF9kYiA6IE15RGF0YWJhc2UgPSBuZXcgTXlEYXRhYmFzZSgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImlcIiAsIHRlbXBbaV0ubmFtZSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaVwiICwgdGVtcFtpXS5leHRlbnNpb24pO1xyXG4gICAgICAgICAgICBpZih0ZW1wW2ldLmV4dGVuc2lvbiA9PSBcIi5kYlwiKXtcclxuICAgICAgICAgICAgICAgIC8vbGV0IHRlbXAyID0gW3RlbXBbaV0ubmFtZSAsIHRlbXBbaV0ucGF0aF07XHJcblxyXG4gICAgICAgICAgICAgICAgbW9kZWxfZGIubmFtZSA9IHRlbXBbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgIG1vZGVsX2RiLnBhdGggPSB0ZW1wW2ldLnBhdGg7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9sZXQgdGVtcDIgPSBbMV1bMV07O1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kYl93b3JkLnB1c2gobW9kZWxfZGIpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0gIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoc2VsZi5kYl93b3JkLmxlbmd0aCA9PSAwKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3QgREFUQUJBU0VcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuZGJfd29yZC5sZW5ndGgpO1xyXG4gICAgICAgIH1lbHNlIGlmKHNlbGYuZGJfd29yZC5sZW5ndGggPT0gMSl7XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmRiX3dvcmQubGVuZ3RoKTtcclxuICAgICAgICAgICAgc2VsZi5teV9kYl9wYXRoID0gc2VsZi5kYl93b3JkWzBdLnBhdGg7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibXlfZGIgPT4gXCIgKyAgc2VsZi5teV9kYl9wYXRoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfWVsc2UgaWYoc2VsZi5kYl93b3JkLmxlbmd0aCA+IDEpe1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5kYl93b3JkLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDAgOyBpIDwgc2VsZi5kYl93b3JkLmxlbmd0aCA7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICBpZihzZWxmLmRiX3dvcmRbaV0ubmFtZSA9PSBcIkVuZ1RvVGhhLmRiXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubXlfZGJfcGF0aCA9IHNlbGYuZGJfd29yZFtpXS5wYXRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKGkgPSBzZWxmLmRiX3dvcmQubGVuZ3RoIC0xICl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZi5teV9kYl9wYXRoID09IFwiXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm15X2RiX3BhdGggPSBzZWxmLmRiX3dvcmRbMF0ucGF0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwibmc9PT09PT09PT09PiBBZnRlclZpZXdJbml0XCIpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVIaXN0b3J5KCl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuZGF0YWJhc2UuZXhlY1NRTChcIkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIEhJU1RPUlkgKGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCx3b3JkX2lkIElOVEVHRVIgLHNUaW1lIERBVEUpXCIpLnRoZW4oaWQgPT57XHJcbiAgICAgICAgICAgIHNlbGYuZGF0YWJhc2UgPSBzZWxmLmRhdGFiYXNlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBISVNUT1JZIFN1Y2Nlc3NcIik7XHJcbiAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDUkVBVEUgVEFCTEUgSElTVE9SWSBFUlJPUlwiICwgZXJyb3IpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVGYXZvcml0ZSgpeyAgIFxyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmRhdGFiYXNlLmV4ZWNTUUwoXCJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBGQVZPUklURSAoaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULHdvcmRfaWQgSU5URUdFUiApXCIpLnRoZW4oaWQgPT57XHJcbiAgICAgICAgICAgIHNlbGYuZGF0YWJhc2UgPSBzZWxmLmRhdGFiYXNlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBGQVZPUklURSBTdWNjZXNzXCIpO1xyXG4gICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBUQUJMRSBGQVZPUklURSBFUlJPUlwiICwgZXJyb3IpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVNeVVzZXIoKXtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi5kYXRhYmFzZS5leGVjU1FMKFwiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgVVNFUlMgKGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCx1c2VybmFtZSBURVhUICwgbmFtZSBURVhUICwgc3RhdHVzIElOVEVHRVIgLCBsb2dpbiBJTlRFR0VSIERFRkFVTFQgMCApXCIpLnRoZW4oaWQgPT57XHJcbiAgICAgICAgICAgIHNlbGYuZGF0YWJhc2UgPSBzZWxmLmRhdGFiYXNlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBVU0VSUyBTdWNjZXNzXCIpO1xyXG4gICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNSRUFURSBUQUJMRSBVU0VSUyBFUlJPUlwiICwgZXJyb3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG5cclxuICAgIHByaXZhdGUgZmV0Y2gyKCl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYudmlld0NoZWNrID0gMTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkdvIHRvID09PT4gZmV0Y2ggMlwiKTtcclxuICAgICAgICB0aGlzLm15X2RiLmFsbChcIlNFTEVDVCBkaWN0X25vICwgZGljdF9zZWFyY2ggLCBkaWN0X21lYW5pbmcgRlJPTSB3b3JkcyBXSEVSRSBkaWN0X25vID4gNDAwIExJTWl0IDEwXCIpLnRoZW4ocm93cyA9PntcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyb3dzKTtcclxuICAgICAgICAgICAgdGhpcy53b3JkX2xpc3QgPSByb3dzO1xyXG4gICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IodmFyIGk9MCA7IGkgPCByb3dzLmxlbmd0aCA7IGkrKyApe1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLnJlZmVzaExpc3QoKTtcclxuICAgICAgICAgICAgc2VsZi5wdXNoTGlzdChyb3dzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTRUxFQ1QgRVJST1IgXCIgLCBlcnJvcik7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcblxyXG4gICAgYnRuSW5zZXJ0KCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJjbGljayBidG5JbnNlcnRcIik7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wiaW5zZXJ0XCJdKSx7XHJcbiAgICAgICAgICAgIHRyYW5zaXRpb246IHtcclxuICAgICAgICAgICAgICAgIG5hbWUgOiBcImZsaXBcIiAsXHJcbiAgICAgICAgICAgICAgICBkdXRhdGlvbjogMjAwMCxcclxuICAgICAgICAgICAgICAgIGN1cnZlOiBcImxpbmVhclwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5idG5TZWxlY3RSYW5kb20oKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBidG5TZWxlY3QoKXtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHNlYXJjaCA9IHNlbGYud29yZF9zZWFyY2g7XHJcbiAgICAgICAgaWYgKHNlYXJjaCA9PSBcIlwiKXtcclxuICAgICAgICAgICAgYWxlcnQoXCLguKHguLXguIrguYjguK3guIfguKfguYjguLLguIfguJnguLDguYTguK3guYnguYLguIfguYggLi4uLi5cIik7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hlY2sgPT0+IFwiICwgXCJTZWxlY3QgPT09PiBcIiArIHNlYXJjaCk7XHJcbiAgICAgICAgICAgICB2YXIgdGVtcCA9IFwiJVwiK3NlYXJjaCtcIiVcIjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHNlbGYubXlfZGIuYWxsKFwiU0VMRUNUIGRpY3Rfbm8gLCBkaWN0X3NlYXJjaCAsIGRpY3RfbWVhbmluZyBGUk9NIHdvcmRzIFdIRVJFIGRpY3Rfc2VhcmNoIExJS0UgKD8pXCIsW3RlbXBdICkudGhlbihyb3dzID0+e1xyXG4gICAgICAgICAgICAgICAgaWYocm93cyA9PVwiXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm90IHdvcmQgPT09PiAgXCIgKyByb3dzICsgXCJpcyBcIiArIHNlYXJjaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLguYTguKHguYjguKHguLXguITguLPguKfguYjguLIgXCIgKyBzZWFyY2ggKyBcIiDguYPguJnguJDguLLguJnguILguYnguK3guKHguLnguKVcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLndvcmRfbGlzdCA9IHJvd3M7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIHJvdyBpbiByb3dzKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3VsdCA9PXZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXN1bHQgYWxsID09PiBcIiAsIHJvd3Nbcm93XSk7Ly9yZXN1bHQgYWxsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlbmdfd29yZCA9PT4gXCIgLCByb3dzW3Jvd11bMV0pOyAvLyByZXN1bHQgZW5nXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0aGFpX3dvcmQgPT0+IFwiICwgcm93c1tyb3ddWzJdKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxlcnJvciA9PntcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBFUlJPUiBcIiAsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBidG5EZWxldGUoKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNrID09ID4gXCIgLCBcIiBEZWxldGVcIik7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wiZGVsZXRlXCJdKSx7IFxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmJ0blNlbGVjdFJhbmRvbSgpO1xyXG4gICAgICAgICBcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0SXRlbSgpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiR0VUIElURU0gPT09PT09PT09PT09PT09PT4gXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgdGVtcF9saXN0IDogQXJyYXk8YW55PjtcclxuICAgICAgICB0ZW1wX2xpc3QgPSBzZWxmLndvcmRfbGlzdDtcclxuICAgIFxyXG4gICAgICAgICBmb3IodmFyIHJvdyBpbiB0ZW1wX2xpc3Qpe1xyXG4gICAgICAgICAgICBsZXQgbW9kZWxfd29yZCA6IFdvcmRJdGVtID0gbmV3IFdvcmRJdGVtKCk7XHJcblxyXG4gICAgICAgICAgICBtb2RlbF93b3JkLmlkID0gdGVtcF9saXN0W3Jvd11bMF07XHJcbiAgICAgICAgICAgIG1vZGVsX3dvcmQuZGljdF9zZWFyY2ggPSB0ZW1wX2xpc3Rbcm93XVsxXTtcclxuICAgICAgICAgICAgbW9kZWxfd29yZC5kaWN0X21lYW5pbmcgPSB0ZW1wX2xpc3Rbcm93XVsyXTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYud29yZF9saXN0Mi5wdXNoKG1vZGVsX3dvcmQpO1xyXG4gICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEl0ZW1TZWxlY3QoKXtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIHNlbGYudmlld0NoZWNrID0gMSA7XHJcblxyXG4gICAgICAgIHZhciBzZWFyY2ggPSBzZWxmLndvcmRfc2VhcmNoO1xyXG4gICAgICAgIGlmIChzZWFyY2ggPT0gXCJcIil7XHJcbiAgICAgICAgICAgIHNlbGYuYnRuU2VsZWN0UmFuZG9tKCk7XHJcbiAgICAgICAgICAgIGFsZXJ0KFwi4Lih4Li14LiK4LmI4Lit4LiH4Lin4LmI4Liy4LiH4LiZ4Liw4LmE4Lit4LmJ4LmC4LiH4LmIIC4uLi4uXCIpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoZWNrID09PiBcIiAsIFwiU2VsZWN0ID09PT4gXCIgKyBzZWFyY2gpO1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IHNlYXJjaCtcIiVcIjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHNlbGYubXlfZGIuYWxsKFwiU0VMRUNUIGRpY3Rfbm8gLCBkaWN0X3NlYXJjaCAsIGRpY3RfbWVhbmluZyBGUk9NIHdvcmRzIFdIRVJFIGRpY3Rfc2VhcmNoIExJS0UgKD8pXCIsW3RlbXBdICkudGhlbihyb3dzID0+e1xyXG4gICAgICAgICAgICAgICAgaWYocm93cyA9PVwiXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm90IHdvcmQgPT09PiAgXCIgKyByb3dzICsgXCJpcyBcIiArIHNlYXJjaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLguYTguKHguYjguKHguLXguITguLPguKfguYjguLIgXCIgKyBzZWFyY2ggKyBcIiDguYPguJnguJDguLLguJnguILguYnguK3guKHguLnguKVcIik7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLndvcmRfc2VhcmNoID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgc2VsZi53b3JkX3NxbCA9IHJvd3M7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlZmVzaExpc3QoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucHVzaExpc3Qocm93cyk7XHJcbiAgICAgICAgICAgICAgICAvL3NlbGYucmVmZXNoTGlzdCgpO1xyXG4gICAgICAgICAgICAgICAgLy9zZWxmLnB1c2hMaXN0KHJvd3MpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTRUxFQ1QgRVJST1IgXCIgLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgLy8gRkFWT1JpVEUgQU5EIEhJU1RPUlkgTk8gVVNFXHJcbiAgICBnZXRJdGVtRmF2b3JpdGUoKXtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi52aWV3Q2hlY2sgPSAxO1xyXG5cclxuXHJcbiAgICAgICAgbGV0IHN0clNRTCA9IFwiU0VMRUNUIHdvcmRfaWQgRlJPTSBGQVZPUklURVwiO1xyXG4gICAgICAgIHNlbGYuZGF0YWJhc2UuYWxsKHN0clNRTCkudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICBzZWxmLndvcmRfc3FsID0gcmVzdWx0O1xyXG4gICAgICAgICAgICBzZWxmLnJlZmVzaExpc3QoKTtcclxuICAgICAgICAgICAgc2VsZi5wdXNoTGlzdChzZWxmLndvcmRfc3FsKTtcclxuICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBGYXZvaXJpdGUgRXJyb3IgPT4gXCIgLCBlcnJvcik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldEl0ZW1IaXN0b3J5KCl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYudmlld0NoZWNrID0gMTtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgc3RyU1FMID0gXCJTRUxFQ1QgaC53b3JkX2lkICwgZC5lbmdXb3JsZCAsIGQudGhhaVdvcmxkICwgZC50eXBlICwgZC5mYXZvcml0ZSBGUk9NIEhJU1RPUlkgaCBqb2luIGRpY3QgZCBvbiBoLndvcmRfaWQgPSBkLmlkIE9SREVSIEJZIGguaWQgREVTQ1wiO1xyXG4gICAgICAgIHNlbGYuZGF0YWJhc2UuYWxsKHN0clNRTCkudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICBzZWxmLndvcmRfc3FsID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgc2VsZi5yZWZlc2hMaXN0KCk7XHJcbiAgICAgICAgICAgICBzZWxmLnB1c2hMaXN0KHNlbGYud29yZF9zcWwpO1xyXG4gICAgICAgIH0sZXJyb3IgPT57XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU0VMRUNUIEhpc3RvcnkgRXJyb3IgPT4gXCIgLCBlcnJvcik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgYnRuU2VsZWN0UmFuZG9tKCl7XHJcblxyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJTZWxlY3QgUmFuZG9tXCIpO1xyXG5cclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi52aWV3Q2hlY2sgPSAwIDtcclxuICAgICAgICBzZWxmLnJlZmVzaExpc3QoKTtcclxuICAgICAgICBzZWxmLm15X2RiLmFsbChcIlNFTEVDVCBkaWN0X25vICwgZGljdF9zZWFyY2ggLCBkaWN0X21lYW5pbmcgRlJPTSB3b3JkcyBXSEVSRSBkaWN0X25vID4gNDAwIE9SREVSIEJZIFJBTkRPTSgpIExJTUlUIDFcIikudGhlbihyb3dzID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyb3dzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZW5nX3dvcmQgPT0+IFwiICwgcm93c1swXVsxXSk7IC8vIHJlc3VsdCB3b3JkXHJcbiAgICAgICAgICAgIHNlbGYud29yZF9yYW5kID0gcm93c1swXVsxXTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0aGFpX3dvcmQgPT0+IFwiICwgcm93c1swXVsyXSk7IC8vcmVzdWx0IG1lYW4gd29yZFxyXG4gICAgICAgICAgICBzZWxmLm1lYW5fcmFuZCA9IHJvd3NbMF1bMl07XHJcbiAgICAgICAgICBcclxuICAgICAgICB9LGVycm9yID0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBFUlJPUiBcIiAsIGVycm9yKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICByZWZlc2hMaXN0KCl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBkZWxQb3AgPSBzZWxmLndvcmRfbGlzdDIubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImRlbHBvcCBsZW5ndGggPT0+XCIgLCBkZWxQb3ApO1xyXG4gICAgICAgICAgICBpZihkZWxQb3AgPjAgKXtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwIDsgaSA8IGRlbFBvcCA7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi53b3JkX2xpc3QyLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVzaExpc3QoYXJncyl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGxldCByb3dzID0gYXJncztcclxuXHJcbiAgICAgICAgZm9yKHZhciByb3cgaW4gcm93cyl7XHJcbiAgICAgICAgICAgIGxldCBtb2RlbF93b3JkIDogV29yZEl0ZW0gPSBuZXcgV29yZEl0ZW0oKTtcclxuICAgICAgICAgICAgbW9kZWxfd29yZC5pZCA9IHJvd3Nbcm93XVswXTtcclxuICAgICAgICAgICAgbW9kZWxfd29yZC5kaWN0X3NlYXJjaCA9IHJvd3Nbcm93XVsxXTtcclxuICAgICAgICAgICAgbW9kZWxfd29yZC5kaWN0X21lYW5pbmcgPSByb3dzW3Jvd11bMl07XHJcblxyXG4gICAgICAgICAgICBzZWxmLndvcmRfbGlzdDIucHVzaChtb2RlbF93b3JkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBvbkl0ZW1UYXAoYXJncykge1xyXG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xyXG5cdFx0bGV0IHdvcmQgPSBzZWxmLndvcmRfbGlzdDJbYXJncy5pbmRleF07XHJcblxyXG4gICAgICAgIGxldCBuYXZpZ2F0aW9uRXh0cmFzOiBOYXZpZ2F0aW9uRXh0cmFzID0ge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgXCJ3b3Jkc1wiOiBKU09OLnN0cmluZ2lmeSh3b3JkKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJsaXN0LWRldGFpbFwiXSwgbmF2aWdhdGlvbkV4dHJhcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TZXR0aW5nKCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJDaGVjayA9PSA+IFwiICwgXCIgb25TZXR0aW5nXCIpO1xyXG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcInNldHRpbmdcIl0pLHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICB9XHJcbiAgICBcclxuIH1cclxuIl19